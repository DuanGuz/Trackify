{% extends "core/base.html" %}
{% load static %}
{% load crispy_forms_tags %}

{% block content %}
<div class="row justify-content-center">
  <div class="col-12 col-md-10 col-lg-8 col-xl-6">

    <!-- Título + volver -->
    <div class="d-flex align-items-center mb-3">
      <h5 class="mb-0">Cambiar contraseña</h5>
      <a href="{% url 'perfil' %}" class="btn btn-light btn-sm ml-auto">
        <i class="fe fe-arrow-left mr-1"></i> Volver a mi perfil
      </a>
    </div>

    <!-- Mensajes flash -->
    {% if messages %}
      {% for message in messages %}
        <div class="alert alert-{{ message.tags|default:'info' }} mb-3">{{ message }}</div>
      {% endfor %}
    {% endif %}

    <!-- Errores globales -->
    {% if form.non_field_errors %}
      <div class="alert alert-danger mb-3">{{ form.non_field_errors }}</div>
    {% endif %}

    <div class="card shadow-sm">
      <div class="card-body">
        <form method="post" action="">
          {% csrf_token %}

          {# Usa crispy si está disponible; si no, cae a as_p #}
          {% if form|crispy %}
            {{ form|crispy }}
          {% else %}
            {{ form.as_p }}
          {% endif %}

          <div class="d-flex mt-4">
            <button type="submit" class="btn btn-primary">
              <i class="fe fe-save mr-1"></i> Actualizar
            </button>
            <a href="{% url 'perfil' %}" class="btn btn-outline-secondary ml-2">
              Cancelar
            </a>
          </div>
        </form>
      </div>
    </div>

  </div>
</div>
{% endblock %}
